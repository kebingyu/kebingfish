{"version":3,"sources":["signup.event.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"signup.event.js","sourcesContent":["$(document).ready(function () {\n    // Remove user from signup list\n    $('.table-striped').on('click', '.user-name', function (e) {\n        e.preventDefault();\n        var self = $(this);\n        var name = self.find('a').text();\n        if (!confirm('Remove ' + name + ' from this event?')) {\n            return;\n        }\n        $.ajax({\n            url: self.find('a').attr('href'),\n            method: \"DELETE\",\n            beforeSend: function () {\n                resetModal();\n            }\n        }).done(function (data) {\n            if (data['ok']) {\n                // Update goer count\n                $('.badge').text(data['data']['goer_count']);\n                // Remove table row\n                self.parent().fadeOut(300, function() {\n                    $(this).remove();\n                });\n                // Popup message\n                showModal(name + '\\'s group has been removed.');\n                return;\n            }\n            // Popup message\n            showModal(data['error'], 'danger');\n        });\n    });\n\n    // Add user from signup list\n    $('form.signup').submit(function (e) {\n        e.preventDefault();\n        var self = $(this);\n        var url = self.attr('action');\n        $.ajax({\n            method: self.attr('method'),\n            url: url,\n            data: self.serialize(),\n            beforeSend: function () {\n                // Clear validation error\n                var div = self.find('.has-error');\n                div.find('.error-block').html('');\n                div.removeClass('has-error');\n                resetModal();\n            }\n        }).done(function (data) {\n            if (data['ok']) {\n                var elem = $('.table-striped tbody');\n                // Update goer count\n                $('.badge').text(data['data']['goer_count']);\n                // Append table row\n                var name = self.find('input[name=\"name\"]').val();\n                var size = self.find('input[name=\"group_size\"]').val() || 1;\n                var html = '<tr>'\n                    + '<td class=\"user-name\">'\n                    + '<a href=\"' + url + '/' + name + '\">' + name + '</a>'\n                    + '</td>'\n                    + '<td class=\"user-group-size\">' + size + '</td>'\n                    + '</tr>';\n                elem.append(html);\n                // Popup message\n                showModal(name + '\\'s group has been added.');\n                return;\n            }\n            // Popup message\n            showModal(data['error'], 'danger');\n        }).fail(function (data) {\n            var error = data.responseJSON;\n            for (var key in error) {\n                var div = $('input[name=\"' + key + '\"]').parents('.form-group');\n                var ul = div.find('.error-block');\n                for (var i = 0, j = error[key].length; i < j; i++) {\n                    var html = '<li class=\"text-danger\">' + error[key][i] + '</li>';\n                    ul.append(html);\n                }\n                div.addClass('has-error');\n            }\n        });\n    });\n\n    function resetModal() {\n        $('#signup-message')\n        .find('.text-success').html('')\n        .end().find('.text-danger').html('');\n    }\n\n    function showModal(message, type) {\n        var type = type || 'success';\n        var elem = '.text-' + type;\n        $('#signup-message').find(elem).html(message).end().modal();\n    }\n});\n"]}