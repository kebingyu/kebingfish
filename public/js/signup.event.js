$(document).ready(function(){function e(){$("#signup-message").find(".text-success").html("").end().find(".text-danger").html("")}function r(e,r){var r=r||"success",t=".text-"+r;$("#signup-message").find(t).html(e).end().modal()}$(".table-striped").on("click",".user-name",function(t){t.preventDefault();var n=$(this),a=n.find("a").text();confirm("Remove "+a+" from this event?")&&$.ajax({url:n.find("a").attr("href"),method:"DELETE",beforeSend:function(){e()}}).done(function(e){return e.ok?($(".badge").text(e.data.goer_count),n.parent().fadeOut(300,function(){$(this).remove()}),void r(a+"'s group has been removed.")):void r(e.error,"danger")})}),$("form.signup").submit(function(t){t.preventDefault();var n=$(this),a=n.attr("action");$.ajax({method:n.attr("method"),url:a,data:n.serialize(),beforeSend:function(){var r=n.find(".has-error");r.find(".error-block").html(""),r.removeClass("has-error"),e()}}).done(function(e){if(e.ok){var t=$(".table-striped tbody");$(".badge").text(e.data.goer_count);var o=n.find('input[name="name"]').val(),d=n.find('input[name="group_size"]').val()||1,i='<tr><td class="user-name"><a href="'+a+"/"+o+'">'+o+'</a></td><td class="user-group-size">'+d+"</td></tr>";return t.append(i),void r(o+"'s group has been added.")}r(e.error,"danger")}).fail(function(e){var r=e.responseJSON;for(var t in r){for(var n=$('input[name="'+t+'"]').parents(".form-group"),a=n.find(".error-block"),o=0,d=r[t].length;o<d;o++){var i='<li class="text-danger">'+r[t][o]+"</li>";a.append(i)}n.addClass("has-error")}})})});